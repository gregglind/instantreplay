<html>

<head>
<style>

#viz {
  border: solid green 1px;
}
</style>

</head>
<body>

<svg id="viz"></svg>


<button id="stop">stop</button>
</body>


<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.1.6/d3.min.js"></script>

<script>
// d3.
/*
get json
- make a box for the window
- tabs open / close / etc
- heatmap?
- cookies etc in a twitter stream?
-

*/

/**
  * assumes n >
  */
var roll = function(n,sides){
  if (sides === undefined){
    sides = n; n = 1;
  }
  if (n < 1) { return 0 }
  var total = 0;
  while (n > 0){
    n--;
    total += Math.floor(sides * Math.random()) + 1
  }
  return total;
}

var randint = function(l,r){
  if (r === undefined){
    r = l; l = 0
  }
  return (r - l) * Math.random() + l
}

var svgh = 500;
var svgw = 300;

var maxx, maxy, tick, r, opacity;
maxx = 900;
maxy = 750;
clock = 100;
r=10;
opacity=.1

var xscale, yscale;

xscale = d3.scale.linear()
    .domain([0,maxx])
    .range([0,svgw]);

yscale = d3.scale.linear()
    .domain([0,maxy])
    .range([0,svgh]);

$(function(){
/*******/
var data = [];

var svg = d3.select('#viz').
  attr("width",svgw).
  attr("height",svgh)

var update = function(){
 svg.
    selectAll("circle").
    data(data).
    enter().
    append('circle').
    attr('r',r).
    attr('cx',function(d, i) { return xscale(d.x) }).
    attr('cy',function(d, i) { return yscale(d.y) }).
    attr('fill','rgba(256,0,0,'+opacity+')')
}

update();

var timer = window.setInterval(function(){
  data.push({x: maxx*Math.random(), y: maxy*Math.random()})
  console.log("data:", data.length, JSON.stringify(data[data.length-1]))
  update();
  },
  clock
)

$("#stop").on("click",function(e){
  window.clearInterval(timer)
})

/*******/
})  // jq



</script>

</html>
